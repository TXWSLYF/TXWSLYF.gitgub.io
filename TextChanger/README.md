# 这是一个kindle标注文件显示器<br/>

## 一.实现了所有的基本功能:<br/>
1.输出bookList<br/>
2.输出每个标注的title,author,position,time,content<br/>

## 二. 实现了全部的加分项：<br/>
1.考虑到了系统切换为英文的情况，实现了position和time的英文解析<br/>
2.实现了time的格式化为 YYYY-MM-DD hh:mm:ss的功能，并将格式化后的时间
添加到了原时间之后<br/>
3.考虑到了content为空的情况，没有将其添加到页面和bookList中去<br/>

## 三.完成思路:<br/>
### ①与本次任务要求的不同处<br/>
1.虽然任务不要求使用Html5的File API，但是因为之前接触过，所以本次任务我
还是采用了Html5 的\<input type="file"\>标签，加上Html5的File API，以用
户上传文本文件的方式，通过后台的解析工作，最后将解析到的内容呈现到网页
上供用户浏览。<br/>
2.虽然任务后来要求sourceString不用包含换行符等，但是因为在这之前就已经
考虑了这些问题，所以输入的文本文件可以包含换行符等，但是即使文本不包含
换行符号，也能顺利完成解析工作<br/>
### ②思路<br/>
1.一开始是打算先将文本文件中的内容以字符串的形式读取，然后先将该字符串
的空白符好全部去除，采用的是String.replace(/\s+/g,"");方法，
这样可以顺利去↵符号等空白符号，之后通过String.split("/={7,}/")方
法将字符串截取为一个个单独的注释，这里之所以采用/={7,}/是为了防止除注
释分隔之外的其他地方有少许"="号出现，之后就可以用正则表达式单独对每条注
释进行信息提取工作了(提取工作有些复杂,所以就不过多提及)，但是这个方法的
弊端也出现了，就是如果出现英文的话会将英文单词之间的空白符去除，导致英
文无法识别。<br/>
2.由于需考虑到英文信息的问题，所以在第一步删除空白符号的时候，不可以删除空格符号，
通过查找资料的方式，了解到[\s]是Unicode空白符的一个不完全子集，等同
于[\f\n\r\t\u000B\u0020\u00A0\u2028\u2029],而其中\u0020代表的是空格符号，所以
我采取了[\f\n\r\t\u000B\u00A0\u2028\u2029\u21B5]代替了[\s]来去除空白符号，
其中\u21B5是↵符号的Unicode编码，这样英文信息的问题便得到了解决<br/>
### ③遇到的问题<br/>
1.因为考虑了系统切换为英文的情况，所以对于时间信息的提取部分要格外小心，由于中
文系统情况下，时间是以数字结尾，而英文情况下，时间是以AM或者PM结尾，所以在正则表达式中
对于辨别英文情况的上午下午添加了一个专门的捕获型分组(\s+[AM|PM]+)?，后面的问号代表
这个分组是可选的，这样可以做到中文和英文注释都可以匹配成功。<br/>
2.由于有的注释的position格式为“xxx”，而有的则为“xxx-xxx”，所以采用了在捕获型分组
中添加了一个可选的非捕获型分组的方法(\d+(?:-\d+)?)，以达到可以同时匹配两种position格式
的目的。<br/>
3.对于一开始的标题和作者信息部分，采用的是两个捕获型分组(.+)\\((.+)\\)，分别捕获标题
和作者信息，但发现如果出现了包含作者的括号中也出现了括号的话，则无法正确识别标题和作者
，思考很久之后决定，将标题和作者只采用一个捕获型分组，将标题和作者捕获到同一个字符串中，
然后采用了字符串的操作方法，成功的正确的分离除了作者和标题。<br/>
## 任务收获<br/>
1.一开始看到任务的时候，心中怯以为任务难度不大，但当真正开始做之后，发现要考虑的
边边角角的情况非常多<br/>
2.这次任务主要用到的是正则表达式方面的知识，虽然之前有过接触，但却从没有分析过复杂点的
字符串，通过这次任务，算是加强了我对于正则表达式的认识和理解。<br/>
3.本次任务我也用到了许多字符串的操作方法，使得我对这些方法的运用也更加的熟练。<br/>
## 参考到的资料
1.一个在线的编码查询转换网站
http://tool.chinaz.com/tools/unicode.aspx<br/>
2.关于input type = "file" 标签的美化方法
http://www.haorooms.com/post/css_input_uploadmh<br/>
## 演示地址<br/>
www.luyufeng.wang/TextChanger<br/>
